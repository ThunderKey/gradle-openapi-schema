plugins {
    id "com.github.muehmar.openapischema" version "2.4.0"
    id "com.diffplug.spotless"
    id 'openapischema.java'
}

dependencies {
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-core', version: '2.15.3'
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: '2.15.3'
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version: '2.15.3'
    implementation group: 'com.fasterxml.jackson.datatype', name: 'jackson-datatype-jsr310', version: '2.15.3'

    testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter', version: '5.10.1'
    testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-params', version: '5.10.1'

    testImplementation group: 'org.hibernate', name: 'hibernate-validator', version: '8.0.1.Final'
    testImplementation group: 'org.glassfish', name: 'jakarta.el', version: '4.0.2'

    implementation group: 'jakarta.validation', name: 'jakarta.validation-api', version: '3.0.2'
}

openApiGenerator {
    validationMethods {
        getterSuffix = "Raw"
    }

    schemas {
        api {
            sourceSet = 'main'
            inputSpec = "$projectDir/src/main/resources/openapi.yml"
            outputDir = "$buildDir/generated/openapi"
            packageName = "${project.group}.${project.name}.api.model"
            jsonSupport = "jackson"
            suffix = "Dto"
            enableValidation = true
            validationApi = "jakarta-3"
            builderMethodPrefix = "set"
        }
    }
}

